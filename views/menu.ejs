<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Menu</title>
    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <form action="/orderList">
      <div class="">
        <div class="">
          <h4>주문하기</h4>
        </div>
        <ul id='listItems' class="">
            <!-- 해당 휴게소의 메뉴 내용 -->
        </ul>
      </div>
      <input type="submit" value="결제하기" />
    </form>
    
  </body>
</html>

<!-- 메뉴 리스트 읽어오기 -->
<script>
    const qs = getQueryStringObject();
    const areaName = qs.area_nm;

    // 서버에서 메뉴 정보 가져오기
    $.ajax({
        url: '/requestMenuInfo',
        type: 'POST',
        data: {
            area_nm: areaName,
        },
        success: function(data) {
            console.log(data);
            drawMenuList(data);
        }
    });

    // qs로 보내준 데이터를(? 이후 데이터) key : value 방식으로 자바스크립트obj 로 풀어주는 함수
    function getQueryStringObject() {
        var a = window.location.search.substr(1).split('&');
        if (a == "") return {};
            var b = {};
        for (var i = 0; i < a.length; ++i) {
            var p = a[i].split('=', 2);
            if (p.length == 1) {
                b[p[0]] = "";
            } else {
                b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
            }
        }
        return b;
    }

    // 메뉴 리스트 그리기
    function drawMenuList(data) {
        const ul = document.getElementById('listItems');
        for(i in data) {
            const li = document.createElement('li');
            
            const br = document.createElement('br');
            
            const input = document.createElement('input');
            input.type = 'checkbox';
            input.name = 'foodNm';
            input.value = data[i].foodNm; 
            
            const namespan = document.createElement('span');
            namespan.innerHTML = data[i].foodNm;
            
            const costspan = document.createElement('span');
            costspan.innerHTML = data[i].foodCost;
            // console.log(data[i].foodNm, data[i].foodCost, data[i].seq);

            li.appendChild(namespan);
            li.appendChild(costspan);
            li.appendChild(input);
            ul.appendChild(li);
            ul.appendChild(br);
        }
    }
</script>